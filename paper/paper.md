
---
title: 'AliNe: A Flexible and Efficient Nextflow Pipeline for Read Alignment'
tags:
  - Nextflow
  - RNA-seq
  - Alignment
authors:
  - name: Jacques Dainat
    orcid: 0000-0002-6629-0173
    affiliation: 1
affiliations:
 - name: Joint Research Unit for Infectious Diseases and Vectors Ecology Genetics Evolution and Control (MIVEGEC), University of Montpellier, French National Center for Scientific Research (CNRS 5290), French National Research Institute for Sustainable Development (IRD 224), 911 Avenue Agropolis, BP 64501, 34394 Montpellier Cedex 5, France.
   index: 1
date: 17 September 2024
bibliography: paper.bib
---

# Summary

Alignment of sequencing reads against a reference genome is a critical step in many bioinformatics workflows, especially in genomics, transcriptomics, and population genetics. Different aligners offer varying performance characteristics in terms of speed, memory efficiency, and accuracy, which makes the selection of an appropriate tool context-dependent. To streamline this process, we present AliNe (Alignment in Nextflow), a flexible and efficient read alignment pipeline built on the Nextflow framework [@nextflow], designed to accommodate a range of commonly used aligners in high-throughput sequencing projects.

AliNe supports short reads (both paired-end and single-end) as well as long reads generated by PacBio and Oxford Nanopore Technologies (ONT). It currently supports 15 widely used alignment tools, including BBMap [@bbmap], Bowtie2 [@bowtie2], BWA [@bwaaln], BWA-MEM [@bwamem], BWA-SW [@bwasw], GraphMap2 [@graphmap2], HISAT2 [@hisat2], Minimap2 [@minimap2], ngmlr [@ngmlr], novoAlign [@novoalign], nucmer [@nucmer], STAR (single or two-pass mode) [@star], subread [@subread], sublong [@subread] and Tophat2 [@tophat2]. These aligners are integrated into a single, easy-to-use workflow, giving users the flexibility to choose the best tool for their specific data and objectives.

AliNe is designed to minimize user inputs and avoid common mistakes like the definition of scoring system used by the sequencing machine (Phred+33, Phred+64 and Solexa), and for RNAseq data the strandness (stranded or unstranded) or the orientation in case of paired-end reads (forward reverse i.e., fr; reverse forward i.e., rf; forward forward i.e., ff). This information may impact the results. If not provided by the user, AliNe will deduce this information and adapt the option of the different downstream aligners accordingly.

The pipeline is modular, enabling future expansion and the integration of additional tools or customization of downstream analysis steps. Users can adapt AliNe to their specific research needs, whether for RNA-seq, ChIP-seq, or whole-genome resequencing projects.

# Statement of Need

The complexity of sequencing data analysis, especially with the advent of next-generation sequencing (NGS), has created a demand for robust, scalable, and reproducible workflows that can handle large datasets while allowing users to flexibly choose their preferred analysis tools. While individual aligners have their own strengths, users often need to evaluate multiple aligners for optimal results or based on specific project requirements. By integrating multiple aligners into a unified pipeline, AliNe simplifies this decision-making process and provides a standard workflow to ensure reproducibility and transparency across analyses.

# Workflow Overview

AliNe takes sequencing reads in FASTQ format as input and aligns them to a user-provided reference genome in FASTA format. The workflow is fully configurable to accommodate various data types, including short paired-end or single-end reads and long reads generated by PacBio or Oxford Nanopore Technologies (ONT). It also allows for the customization of alignment parameters specific to each tool.

AliNe integrates optional read trimming using Fastp [@fastp] and provides optional quality control at every stage with FastQC [@fastqc]. For RNA-seq data, the pipeline automatically detects the library type via Salmon [@salmon] and configures the appropriate parameters for downstream alignment tools accordingly.

Additionally, AliNe uses SeqKit [@seqkit] to detect the sequence quality scoring system and standardizes it to Phred+33 if necessary. Once preprocessing is complete, alignment is performed using the aligners selected by the user. Finally, with the help of Samtools [@samtools], AliNe outputs aligned reads in sorted BAM format, ready for downstream analyses such as variant calling, gene expression quantification, or structural variation detection.

A final stage will resume all FastQC analyses, and output from compatible aligners using MultiQC [@multiqc]. 

The pipeline supports parallel execution, ensuring efficient processing of large datasets by distributing tasks across available CPU cores. With Nextflow's inherent support for reproducibility, users can confidently rerun analyses with consistent results.

# Availability

AliNe is freely available under an open-source license. The source code, along with detailed documentation and examples, can be found at [https://github.com/Juke34/AliNe](https://github.com/Juke34/AliNe). Contributions and community feedback are welcome.

# References